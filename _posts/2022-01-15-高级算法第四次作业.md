---
layout: post
title: 高级算法第四次作业
description: >
  2021秋季高级算法第四次作业
tags: [大三第一学期]
author: zcy
---

# 高级算法第四次作业

赵超懿 191870271

## 第一题

### (1)

$$
minimize\quad \sum_{v\in V}y_v\\
subject\quad to:\sum_{v\in e}y_v \geq w_e,e\in E\\
y_v\in [0,1]
$$

### (2)

$OPT=OPT_{ILP}\leq OPT_{dual-LP}=\sum_{v\in V}y_v^{*}$

$OPT_{dual-LP}\geq 2\sum_{e\in E}w_e,OPT\leq \sum\limits_{e\in E}w_e$

$\dfrac{OPT}{OPT_{LP}}=\dfrac{OPT}{OPT_{dual-LP}}\leq \dfrac{\sum\limits_{e\in E}w_e}{2\sum\limits_{e\in E}w_e}=\dfrac{1}{2}$

所以integrality gap是$\dfrac{1}{2}$

## 第二题

记$A_e$为$e$没有被二染色的事件，考虑随机染色

$Pr[A_e]\leq \dfrac{1}{2^{k-1}}=p$,$A_e$之多和$k(k-1)$条有公共顶点

由Lovasz Local Lemma,$p=\dfrac{1}{2^{k-1}},d\leq k(k-1)$

$f(k)=ep(d+1)=\dfrac{e}{2^{k-1}}\times k(k-1)$

$\lim\limits_{k\rightarrow +\infty}f(k) = 0 < 1\Rightarrow Pr[\mathop\wedge\limits_{e\in E}\bar{A}_e] > 0$，所以一定存在一种二染色满足要求，当k足够大时存在性得证。

当$k\geq 9$时，$f(k)<1$,$k < 9$时，$f(k) > 1$，所以k最小可以取到9.

## 第三题

### (1)

将题目写成线性规划如下

$$
\max\quad \sum_{(u,v)\in E}x_ux_v+\sum_{(u,v)\in F}(1-x_ux_v)\\
subject\quad to:x_ux_v\geq 0,\forall u,v\in V\\
\qquad |x_u|=1,x_u\in\{0,1\}^{|V|}
$$

将上述规划改成SDP，SDP形式显然是上界

### (2)

选择任意两个单位向量:$\alpha,\beta,\theta_{\alpha,\beta}=\dfrac{<\alpha,\beta>}{|\alpha|\cdot |\beta|}=<\alpha,\beta>$

定义$\forall x_v,f(x_v)=(sgn(xv,\alpha),sgn(x_v,\beta))$，根据$f(x_v)$的结果将其分到不同的四个类别：$\{x|f(x)=(1,1)\},\{x|f(x)=(-1,1)\},\{x|f(x)=(1,-1)\},\{x|f(x)=(-1,-1)\}$

$$
\begin{aligned}
    Pr[f(x_v)=f(x_u)]&=Pr[sgn(x_v,\alpha)=sgn(x_u,\alpha)]\cdot Pr[sgn(x_v,\beta)=sgn(x_u,\beta)]\\
    &=(1-\dfrac{\theta_{uv}}{\pi})^2\\
    &=(1-\dfrac{\arccos(<x_u,x_v>)}{\pi})^2
\end{aligned}
$$

$$
Pr[f(x_v)\neq f(x_u)]=1-(1-\dfrac{\arccos(<x_u,x_v>)}{\pi})^2
$$

$$
\begin{aligned}
    E[SOL]&=\sum_{(u,v)\in E}Pr[f(x_u)=f(x_v)]+\sum_{(u,v)\in F}Pr[f(x_v)\neq f(x_u)]\\
    &=\sum_{(u,v)\in E}(1-\dfrac{\arccos(<x_u,x_v>)}{\pi})^2+\sum_{(u,v)\in F}(1-(1-\dfrac{\arccos(<x_u,x_v>)}{\pi})^2)\\
    &\geq \alpha(\sum_{(u,v)\in E}<x_u,x_v>+\sum_{(u,v)\in F}(1-<x_u,x_v>))
\end{aligned}
$$

下面求$\alpha$，各自进行对应

$$
(1-\dfrac{\arccos(x)}{\pi})^2 \geq \alpha x\Rightarrow
\alpha\leq \dfrac{1}{x} (1-\dfrac{\arccos(x)}{\pi})^2 = h_1(x)
$$

$$
1-(1-\dfrac{\arccos(x)}{\pi})^2\geq \alpha(1-x)\Rightarrow
\alpha\leq \dfrac{1}{1-x}(1-(1-\dfrac{\arccos(x)}{\pi})^2)=h_2(x)
$$

$h_1(x)$在(0,1)最小值约为$0.7895$，$\min{h_2(x)}=0.75$

所以$E[SOL]\geq \alpha(\sum_{(u,v)\in E}<x_u,x_v>+\sum_{(u,v)\in F}(1-<x_u,x_v>))=SDP$,$\alpha = 0.75$

## 第四题

### (1)

归纳法，假设k时成立，当k+1时

$$
\begin{aligned}
    \pi(x)P^k(x,y)&=\pi(x)\sum_{i}P^k(x,i)P(i,y)\\
    &=\sum_{i}\pi(x)P^k(x,i)P(i,y)\\
    &=\sum_{i}\pi(i)P^k(i,x)P(i,y)\\
    &=\sum_{i}\pi(y)P(y,i)P^k(i,x)\\
    &=\pi(y)\sum_{i}P(y,i)P^k(i,x)\\
    &=\pi(y)P^{k+1}(y,x)
\end{aligned}
$$

证毕

### (2)

$\Rightarrow$

$$
\begin{aligned}
<f,Pg>_{\pi}=&\sum_{x\in \Omega}\pi(x)f(x)Pg(x)\\
=&\sum_{x\in \Omega}\pi(x)f(x)\sum_{y\in \Omega}P(x,y)g(y)\\
=&\sum_{x\in \Omega}\sum_{y\in \Omega}\pi(x)P(x,y)f(x)g(y)\\
=&\sum_{y\in \Omega}\sum_{x\in \Omega}\pi(y)P(y,x)f(y)g(x)\\
=&\sum_{y\in \Omega}\sum_{x\in \Omega}\pi(x)P(x,y)f(y)g(x)(细致平衡)\\
\end{aligned}
$$

同理
$$
\begin{aligned}
<Pf,g>_{\pi}=&\sum_{x\in \Omega}\pi(x)Pf(x)g(x)\\
=&\sum_{x\in \Omega}\pi(x)g(x)\sum_{y\in \Omega}P(x,y)f(y)\\
=&\sum_{x\in \Omega}\sum_{y\in \Omega}\pi(x)P(x,y)f(y)g(x)\\
\end{aligned}
$$

$<Pf,g>_{\pi}$的$(x,y)项$和$<f,Pg>_{\pi}$的$(y,x)$项对应相等，所以二者相等

$\Leftarrow$

取特定的$x_0,y_0$,使得$f(x_0)=g(y_0)=1,f(x)=g(y)=0,x\neq x_0,y\neq y_0$.

$$
\begin{aligned}
<f,Pg>_{\pi}=&\sum_{x\in \Omega}\pi(x)f(x)Pg(x)\\
=&\sum_{x\in \Omega}\pi(x)f(x)\sum_{y\in \Omega}P(x,y)g(y)\\
=&\sum_{x\in \Omega}\sum_{y\in \Omega}\pi(x)P(x,y)f(x)g(y)\\
=&\sum_{y\in \Omega}\sum_{x\in \Omega}\pi(y)P(y,x)f(y)g(x)\\
=&\pi(y_0)P(y_0,x_0)
\end{aligned}
$$

$$
\begin{aligned}
<Pf,g>_{\pi}=&\sum_{x\in \Omega}\pi(x)Pf(x)g(x)\\
=&\sum_{x\in \Omega}\pi(x)g(x)\sum_{y\in \Omega}P(x,y)f(y)\\
=&\sum_{x\in \Omega}\sum_{y\in \Omega}\pi(x)P(x,y)f(y)g(x)\\
=&\pi(x_0)P(x_0,y_0)
\end{aligned}
$$

二者相等，所以$\pi(y_0)P(y_0,x_0)=\pi(x_0)P(x_0,y_0)$，由于$f,g$是任意的，所以分别取遍$\Omega$中的$x,y$的组合构成如上函数$f,g$，则可以得到对任意的$x,y\in \Omega,\pi(x)P(x,y)=\pi(y)P(y,x)$.

### (3)

$\Rightarrow$

$$
\begin{aligned}
<f,Pg>_{\pi_1}=&\sum_{x\in \Omega_1}\pi_1(x)f(x)P_{12}g(x)\\
=&\sum_{x\in \Omega_1}\pi_1(x)f(x)\sum_{y\in \Omega_2}P_{12}(x,y)g(y)\\
=&\sum_{x\in \Omega_1}\sum_{y\in \Omega_2}\pi_1(x)P_{12}(x,y)f(x)g(y)\\
=&\sum_{x\in \Omega_1}\sum_{y\in \Omega_2}\pi_2(y)P_{21}(y,x)f(x)g(y)(等式)\\
=&\sum_{y\in \Omega_2}\sum_{x\in \Omega_1}\pi_2(x)P_{21}(x,y)f(y)g(x)
\end{aligned}
$$

同理
$$
\begin{aligned}
<Pf,g>_{\pi_2}=&\sum_{x\in \Omega_2}\pi_2(x)P_{21}f(x)g(x)\\
=&\sum_{x\in \Omega_1}\pi_2(x)g(x)\sum_{y\in \Omega_2}P_{21}(x,y)f(y)\\
=&\sum_{x\in \Omega_1}\sum_{y\in \Omega_2}\pi_2(x)P_{21}(x,y)f(y)g(x)\\
\end{aligned}
$$

$<P_{12}f,g>_{\pi_1}$的$(x,y)项$和$<f,P_{21}g>_{\pi_2}$的$(y,x)$项对应相等，所以二者相等

$\Leftarrow$

取特定的$x_0\in \Omega_1,y_0\in \Omega_2$,使得$f(x_0)=1,g(y_0)=1$,其中$f(x)=0,g(y)=0,当x\neq x_0,y\neq y_0$时.

$$
\begin{aligned}
<f,P_{12}g>_{\pi_1}=&\sum_{x\in \Omega_1}\pi_1(x)f(x)P_{12}g(x)\\
=&\sum_{x\in \Omega_1}\pi_1(x)f(x)\sum_{y\in \Omega_2}P_{12}(x,y)g(y)\\
=&\sum_{x\in \Omega_1}\sum_{y\in \Omega_2}\pi_1(x)P_{12}(x,y)f(x)g(y)\\
=&\sum_{y\in \Omega_1}\sum_{x\in \Omega_2}\pi_1(y)P_{12}(y,x)f(y)g(x)\\
=&\pi_1(y_0)P_{12}(y_0,x_0)
\end{aligned}
$$

$$
\begin{aligned}
<P_{21}f,g>_{\pi_2}=&\sum_{x\in \Omega_2}\pi_2(x)P_{21}f(x)g(x)\\
=&\sum_{x\in \Omega_2}\pi_2(x)g(x)\sum_{y\in \Omega_1}P_{21}(x,y)f(y)\\
=&\sum_{x\in \Omega_2}\sum_{y\in \Omega_1}\pi_2(x)P_{21}(x,y)f(y)g(x)\\
=&\pi_2(x_0)P_{21}(x_0,y_0)
\end{aligned}
$$

二者相等，所以$\pi_1(y_0)P_{12}(y_0,x_0)=\pi_2(x_0)P_{21}(x_0,y_0)$，由于$f,g$是任意的，所以分别取遍$\Omega_1\times \Omega_2$中的$(x,y)$的组合构成如上函数$f,g$，则可以得到对任意的$x\in \Omega_1,y\in \Omega_2,\pi_1(x)P_{12}(x,y)=\pi_2(y)P_{21}(y,x)$.

证明半正定：

$P$满足细致平衡条件,$\pi_1$是平衡状态
$$
\begin{align}
\pi_1(x)P(x,y)&=\pi_1(x)\sum\limits_{j}P_{12}(x,j)P_{21}(j,y)\\
&=\sum\limits_{j}\pi_1(x)P_{12}(x,j)P_{21}(j,y)\\
&=\sum\limits_{j}\pi_2(j)P_{21}(j,x)P_{21}(j,y)\\
&=\sum\limits_{j}P_{21}(j,x)\pi_1(y)P_{12}(y,j)\\
&=\pi_1(y)\sum\limits_{j}P_{12}(y,j)P_{21}(j,x)\\
&=\pi_1(y)P(y,x)
\end{align}
$$
P和一对称阵相似
$$
P=V^{-1}SV,其中V=dag(\sqrt{\pi_1(1)},\sqrt{\pi_1(2)},...,\sqrt{\pi_1(n)})
$$

$$
S_{i,j}=\dfrac{\sqrt{\pi_1(j)}}{\sqrt{\pi_1(i)}}P_{ij}=\dfrac{\sqrt{\pi_1(i)}}{\sqrt{\pi_1(j)}}P_{ji}=S_{j,i}
$$

剩下的不会证。。
